/*! enclaveweb 2017-05-17 */
$(function(){function a(){u.keydown(function(a){a.preventDefault(),116===a.keyCode&&b()})}function b(){$(".artList").addClass("loadingBg"),$.get(P.al,function(a){if(200==a.code){M.supports_ls()&&(M.setls(J.aL,JSON.stringify(a)),M.setls(J.aLT,(new Date).getTime()));var b=a.result.data;b.length=9,c(w,b),$(".artList").removeClass("loadingBg")}})}function c(a,b){switch(a){case w:w.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><img src='+b.art_thumb+' alt=""></a><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><h3>'+b.art_title+'</h3></a><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><p class="des">'+b.art_description+'</p></a><div class="editor"><p><span class="mark">'+b.cate_name+"</span>"+b.art_editor+"</p></div></li>";w.append($(c))});break;case B:var c='<img src="'+b.art_thumb+'" alt=""><h1>'+b.art_title+'</h1><div class="author"><img src="'+b.editor_avatar+'" alt=""><span>'+b.art_editor+" · "+r(1e3*b.art_time)+"</span></div>"+b.art_content.replace(/\/ueditor\/php/g,P.homepage+"/ueditor/php")+'<div class="readOther"><span class="left mark">'+b.cate_name+'</span><span class="reads"><i></i>'+b.art_view+"</span></div>";B.html($(c));break;case x:x.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><img src='+b.art_thumb+' alt=""></a><div class="summary"><h2>'+b.art_title+"</h2><p>"+b.art_description+'</p><div><p><span class="mark">'+b.cate_name+"</span>"+b.art_editor+"</p></div></div></li>";x.append($(c))});break;case y:y.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><img src='+b.art_thumb+' alt=""></a><div><h2>'+b.art_title+"</h2><p>"+b.art_description+"</p></li>";y.append($(c))});break;case z:z.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><img src='+b.art_thumb+' alt=""></a><div><h3>'+b.art_title+"</h3><p>"+b.art_description+"</p></div></li>";z.append($(c))});break;case A:var c='<img src="'+b.art_thumb+'" alt=""><h1>'+b.art_title+'</h1><div class="author"><span>'+b.art_editor+" · "+r(1e3*b.art_time)+"</span></div>"+b.art_content.replace(/\/ueditor\/php/g,P.homepage+"/ueditor/php")+'<div class="readOther"><span class="left mark">'+b.cate_name+'</span><span class="reads"><i></i>'+b.art_view+"</span></div>";A.html($(c))}}function d(){var a=JSON.parse(N),b=a.result.data;b.length=9,c(w,b)}function e(){if(O){return!!((new Date).getTime()-O<I)}return!1}function f(){N&&e()?d():b()}function g(a){var b=location.search.split("=")[1],d=b.substring(K),e=d.substring(0,d.length-L);$.get(P.ad+"art_id="+e,function(b){if(200==b.code){var d=b.result;a?c(B,d):c(A,d)}}),h(a)}function h(a){$.get(P.ar,function(b){if(200==b.code){var d=b.result.data;a?c(x,d):c(y,d)}})}function i(){u.scroll(function(){var a=C.height();u.scrollTop()>a?C.addClass("fixedTop"):C.removeClass("fixedTop")})}function j(){var a=0;E.length==D.length&&(E.on("click",function(){E.removeAttr("class"),$(this).addClass("curr"),a=E.index($(this)),D.hide(),D.eq(a).show()}),location.search&&k(E,D))}function k(a,b){var c=location.search.split("=")[1];a.removeAttr("class"),$(a[c]).addClass("curr"),b.hide(),b.eq(c).show()}function l(){var a=u.width(),b=a,c=u.height();v.css({width:b,height:c})}function m(){H.on("click",function(){$("body,html").animate({scrollTop:u.height()},400)})}function n(){$(".m_artList").addClass("loadingBg"),$.get(P.al,function(a){if(200==a.code){var b=a.result.data;b.length=6,c(z,b),$(".m_artList").removeClass("loadingBg")}})}function o(){G.css({top:u.scrollTop(),height:window.innerHeight}),G.fadeIn(100),u.on("touchmove",function(a){a.preventDefault()})}function p(){G.fadeOut(100),u.off("touchmove")}function q(a){return a<10?"0"+a:a}function r(a){var b=new Date(a),c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds();return c+"-"+q(d)+"-"+q(e)+" "+q(f)+":"+q(g)+":"+q(h)}function s(){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=a.length,c=[],d=[],e=0;e<K;e++)c.push(a.charAt(t(0,b)));for(var f=0;f<L;f++)d.push(a.charAt(t(0,b)));return{preFix:c.join(""),postFix:d.join("")}}function t(a,b){var c=b-a;return Math.floor(Math.random()*c+a)}var u=$(window),v=$("#header"),w=$(".artList>ul"),x=$(".recommend>ul"),y=$(".m_recommend>ul"),z=$(".m_artList>ul"),A=$(".m_details"),B=$(".article_detail"),C=$(".article_head"),D=$(".menu_con"),E=$(".menu > a"),F=$("#m_weChat"),G=$("#mask"),H=$(".arrow"),I=108e5,J={aL:"artList",aLT:"artList_time"},K=6,L=3,M={supports_ls:function(){return!!window.localStorage},setls:function(a,b){window.localStorage[a]=b},getls:function(a){return window.localStorage[a]},rmls:function(a){window.localStorage.removeItem[a]}},N=!!M.supports_ls()&&M.getls(J.aL),O=!!M.supports_ls()&&M.getls(J.aLT)-0,P={al:"https://app.enclavebooks.cn/v1_4/index",ad:"http://app.enclavebooks.cn/v1_4/article?",ar:"http://app.enclavebooks.cn/v1_4/recommend",homepage:"http://app.enclavebooks.cn"},Q=0,R=$(".imgcls"),S=R.length;0!=w.length&&f(),0!=w.length&&a(),0!=B.length&&g(!0),0!=A.length&&g(!1),0!=C.length&&i(),0!=D.length&&j(),v&&l(),H&&m(),0!=z.length&&n(),0!=S&&window.setInterval(function(){Q==S-1?Q=0:Q++,R.removeClass("active").removeClass("before"),R.eq(Q).addClass("active"),0==Q?R.eq(S-1).addClass("before"):R.eq(Q-1).addClass("before")},5e3),F.on("click",function(){o()}),G.on("click",function(){p()})});