/*! enclaveweb 2017-05-12 */
$(function(){function a(){s.keydown(function(a){a.preventDefault(),116===a.keyCode&&b()})}function b(){$(".artList").addClass("loadingBg"),$.get(L.al,function(a){if(200==a.code){I.supports_ls()&&(I.setls(H.aL,JSON.stringify(a)),I.setls(H.aLT,(new Date).getTime()));var b=a.result.data;b.length=9,c(u,b),$(".artList").removeClass("loadingBg")}})}function c(a,b){switch(a){case u:u.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+b.art_id+'" ><img src='+b.art_thumb+' alt=""></a><a href="article.html?art_id='+b.art_id+'" ><h3>'+b.art_title+'</h3></a><a href="article.html?art_id='+b.art_id+'" ><p class="des">'+b.art_description+'</p></a><div class="editor"><p><span class="mark">'+b.cate_name+"</span>"+b.art_editor+"</p></div></li>";u.append($(c))});break;case z:var c='<img src="'+b.art_thumb+'" alt=""><h1>'+b.art_title+'</h1><div class="author"><img src="'+b.editor_avatar+'" alt=""><span>'+b.art_editor+" · "+r(1e3*b.art_time)+"</span></div>"+b.art_content.replace(/\/ueditor\/php/g,L.homepage+"/ueditor/php")+'<div class="readOther"><span class="left mark">'+b.cate_name+'</span><span class="reads"><i></i>'+b.art_view+"</span></div>";z.html($(c));break;case v:v.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+b.art_id+'" ><img src='+b.art_thumb+' alt=""></a><div class="summary"><h2>'+b.art_title+"</h2><p>"+b.art_description+'</p><div><p><span class="mark">'+b.cate_name+"</span>"+b.art_editor+"</p></div></div></li>";v.append($(c))});break;case w:w.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+b.art_id+'" ><img src='+b.art_thumb+' alt=""></a><div><h2>'+b.art_title+"</h2><p>"+b.art_description+"</p></li>";w.append($(c))});break;case x:x.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+b.art_id+'" ><img src='+b.art_thumb+' alt=""></a><div><h3>'+b.art_title+"</h3><p>"+b.art_description+"</p></div></li>";x.append($(c))});break;case y:var c='<img src="'+b.art_thumb+'" alt=""><h1>'+b.art_title+'</h1><div class="author"><span>'+b.art_editor+" · "+r(1e3*b.art_time)+"</span></div>"+b.art_content.replace(/\/ueditor\/php/g,L.homepage+"/ueditor/php")+'<div class="readOther"><span class="left mark">'+b.cate_name+'</span><span class="reads"><i></i>'+b.art_view+"</span></div>";y.html($(c))}}function d(){var a=JSON.parse(J),b=a.result.data;b.length=9,c(u,b)}function e(){if(K){return!!((new Date).getTime()-K<G)}return!1}function f(){J&&e()?d():b()}function g(a){var b=location.search.substring(1);$.get(L.ad+b,function(b){if(200==b.code){var d=b.result;a?c(z,d):c(y,d)}}),h(a)}function h(a){$.get(L.ar,function(b){if(200==b.code){var d=b.result.data;a?c(v,d):c(w,d)}})}function i(){s.scroll(function(){var a=A.height();s.scrollTop()>a?A.addClass("fixedTop"):A.removeClass("fixedTop")})}function j(){var a=0;C.length==B.length&&(C.on("click",function(){C.removeAttr("class"),$(this).addClass("curr"),a=C.index($(this)),B.hide(),B.eq(a).show()}),location.search&&k(C,B))}function k(a,b){var c=location.search.split("=")[1];a.removeAttr("class"),$(a[c]).addClass("curr"),b.hide(),b.eq(c).show()}function l(){var a=s.width(),b=a,c=s.height();t.css({width:b,height:c})}function m(){F.on("click",function(){$("body,html").animate({scrollTop:s.height()},400)})}function n(){$(".m_artList").addClass("loadingBg"),$.get(L.al,function(a){if(200==a.code){var b=a.result.data;b.length=6,c(x,b),$(".m_artList").removeClass("loadingBg")}})}function o(){E.css({top:s.scrollTop(),height:window.innerHeight}),E.fadeIn(100),s.on("touchmove",function(a){a.preventDefault()})}function p(){E.fadeOut(100),s.off("touchmove",function(a){a.preventDefault()})}function q(a){return a<10?"0"+a:a}function r(a){var b=new Date(a),c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds();return c+"-"+q(d)+"-"+q(e)+" "+q(f)+":"+q(g)+":"+q(h)}var s=$(window),t=$("#header"),u=$(".artList>ul"),v=$(".recommend>ul"),w=$(".m_recommend>ul"),x=$(".m_artList>ul"),y=$(".m_details"),z=$(".article_detail"),A=$(".article_head"),B=$(".menu_con"),C=$(".menu > a"),D=$("#m_weChat"),E=$("#mask"),F=$(".arrow"),G=108e5,H={aL:"artList",aLT:"artList_time"},I={supports_ls:function(){return!!window.localStorage},setls:function(a,b){window.localStorage[a]=b},getls:function(a){return window.localStorage[a]},rmls:function(a){window.localStorage.removeItem[a]}},J=!!I.supports_ls()&&I.getls(H.aL),K=!!I.supports_ls()&&I.getls(H.aLT)-0,L={al:"https://app.enclavebooks.cn/v1_4/index",ad:"http://app.enclavebooks.cn/v1_4/article?",ar:"http://app.enclavebooks.cn/v1_4/recommend",homepage:"http://app.enclavebooks.cn"},M=0,N=$(".imgcls"),O=N.length;0!=u.length&&f(),0!=u.length&&a(),0!=z.length&&g(!0),0!=y.length&&g(!1),0!=A.length&&i(),0!=B.length&&j(),t&&l(),F&&m(),0!=x.length&&n(),0!=O&&window.setInterval(function(){M==O-1?M=0:M++,N.removeClass("active").removeClass("before"),N.eq(M).addClass("active"),0==M?N.eq(O-1).addClass("before"):N.eq(M-1).addClass("before")},5e3),D.on("click",function(){o()}),E.on("click",function(){p()})});