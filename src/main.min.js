/*! enclaveweb 2017-05-25 */
$(function(){function a(){w.keydown(function(a){a.preventDefault(),116===a.keyCode&&b()})}function b(){$(".artList").addClass("loadingBg"),$.get(T.al,function(a){if(200==a.code){Q.supports_ls()&&(Q.setls(N.aL,JSON.stringify(a)),Q.setls(N.aLT,(new Date).getTime()));var b=a.result.data;b.length=9,c(y,b),$(".artList").removeClass("loadingBg")}})}function c(a,b){switch(a){case y:y.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><img src='+b.art_thumb+' alt=""></a><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><h3>'+b.art_title+'</h3></a><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><p class="des">'+b.art_description+'</p></a><div class="editor"><p><span class="mark">'+b.cate_name+"</span>"+b.art_editor+"</p></div></li>";y.append($(c))});break;case D:var c='<img src="'+b.art_thumb+'" alt=""><h1>'+b.art_title+'</h1><div class="author"><img src="'+b.editor_avatar+'" alt=""><span>'+b.art_editor+" · "+r(1e3*b.art_time)+"</span></div>"+b.art_content.replace(/\/ueditor\/php/g,T.homepage+"/ueditor/php")+'<div class="readOther"><span class="left mark">'+b.cate_name+'</span><span class="reads"><i></i>'+b.art_view+"</span></div>";D.html($(c));break;case z:z.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><img src='+b.art_thumb+' alt=""></a><div class="summary"><h2>'+b.art_title+"</h2><p>"+b.art_description+'</p><div><p><span class="mark">'+b.cate_name+"</span>"+b.art_editor+"</p></div></div></li>";z.append($(c))});break;case A:A.html(""),$.each(b,function(a,b){var c='<a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><li><div class="imgWrap"><img src='+b.art_thumb+' alt=""></div><div class="des"><h3>'+b.art_title+"</h3><p>"+b.art_description+"</p></li></a>";A.append($(c))});break;case B:B.html(""),$.each(b,function(a,b){var c='<a href="article.html?art_id='+s().preFix+b.art_id+s().postFix+'" ><li><div class="imgWrap"><img src='+b.art_thumb+' alt=""></div><div class="des"><h3>'+b.art_title+"</h3><p>"+b.art_description+"</p></div></li></a>";B.append($(c))});break;case C:var c='<img src="'+b.art_thumb+'" alt=""><h1>'+b.art_title+'</h1><div class="author"><span>'+b.art_editor+" · "+r(1e3*b.art_time)+"</span></div>"+b.art_content.replace(/\/ueditor\/php/g,T.homepage+"/ueditor/php")+'<div class="readOther"><span class="left mark">'+b.cate_name+'</span><span class="reads"><i></i>'+b.art_view+"</span></div>";C.html($(c))}}function d(){var a=JSON.parse(R),b=a.result.data;b.length=9,c(y,b)}function e(){if(S){return!!((new Date).getTime()-S<M)}return!1}function f(){R&&e()?d():b()}function g(a){var b=location.search.split("=")[1],d=b.substring(O),e=d.substring(0,d.length-P);$.get(T.ad+"art_id="+e,function(b){if(200==b.code){var d=b.result;a?c(D,d):c(C,d)}}),h(a)}function h(a){$.get(T.ar,function(b){if(200==b.code){var d=b.result.data;a?c(z,d):c(A,d)}})}function i(a){w.scroll(function(){var b=a.outerHeight();if($(document).height()<w.height()+b)return void(a.hasClass("fixedTop")&&a.removeClass("fixedTop"));w.scrollTop()>b?a.addClass("fixedTop"):a.removeClass("fixedTop")})}function j(){var a=0;I.length==G.length&&(I.on("click",function(){I.removeAttr("class"),$(this).addClass("curr"),a=I.index($(this)),G.hide(),G.eq(a).show()}),location.search&&k(I,G))}function k(a,b){var c=location.search.split("=")[1];a.removeAttr("class"),$(a[c]).addClass("curr"),b.hide(),b.eq(c).show()}function l(){var a=w.width(),b=a,c=w.height();x.css({width:b,height:c})}function m(){L.on("click",function(){$("body,html").animate({scrollTop:w.height()},400)})}function n(){$(".m_artList").addClass("loadingBg"),$.get(T.al,function(a){if(200==a.code){var b=a.result.data;b.length=6,c(B,b),$(".m_artList").removeClass("loadingBg")}})}function o(){K.css({top:w.scrollTop(),height:window.innerHeight}),K.fadeIn(100),w.on("touchmove",function(a){a.preventDefault()})}function p(){K.fadeOut(100),w.off("touchmove")}function q(a){return a<10?"0"+a:a}function r(a){var b=new Date(a),c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds();return c+"-"+q(d)+"-"+q(e)+" "+q(f)+":"+q(g)+":"+q(h)}function s(){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=a.length,c=[],d=[],e=0;e<O;e++)c.push(a.charAt(t(0,b)));for(var f=0;f<P;f++)d.push(a.charAt(t(0,b)));return{preFix:c.join(""),postFix:d.join("")}}function t(a,b){var c=b-a;return Math.floor(Math.random()*c+a)}function u(){var a=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(a)?"iOS":/android/.test(a)?"Android":"Desktop"}function v(){var a=u();"iOS"==a?window.location.href="https://itunes.apple.com/us/app/fei-de/id1179249797?mt=8":(a="Android")?window.location.href="https://apk.enclavebooks.cn/enclave.apk":window.location.href="index.html"}var w=$(window),x=$("#header"),y=$(".artList>ul"),z=$(".recommend>ul"),A=$(".m_recommend>ul"),B=$(".m_artList>ul"),C=$(".m_details"),D=$(".article_detail"),E=$(".article_head"),F=$(".mdetail_head"),G=$(".menu_con"),H=$("#downApp"),I=$(".menu > a"),J=$("#m_weChat"),K=$("#mask"),L=$(".arrow"),M=108e5,N={aL:"artList",aLT:"artList_time"},O=6,P=3,Q={supports_ls:function(){return!!window.localStorage},setls:function(a,b){window.localStorage[a]=b},getls:function(a){return window.localStorage[a]},rmls:function(a){window.localStorage.removeItem[a]}},R=!!Q.supports_ls()&&Q.getls(N.aL),S=!!Q.supports_ls()&&Q.getls(N.aLT)-0,T={al:"https://app.enclavebooks.cn/v1_4/index",ad:"https://app.enclavebooks.cn/v1_4/article?",ar:"https://app.enclavebooks.cn/v1_4/recommend",homepage:"https://app.enclavebooks.cn"},U=0,V=$(".imgcls"),W=V.length;0!=y.length&&f(),0!=y.length&&a(),0!=D.length&&g(!0),0!=C.length&&g(!1),0!=E.length&&i(E),0!=F.length&&i(F),0!=G.length&&j(),x&&l(),L&&m(),0!=B.length&&n(),0!=W&&window.setInterval(function(){U==W-1?U=0:U++,V.removeClass("active").removeClass("before"),V.eq(U).addClass("active"),0==U?V.eq(W-1).addClass("before"):V.eq(U-1).addClass("before")},5e3),J.on("click",function(){o()}),K.on("click",function(){p()}),H&&H.on("click",function(a){v()})});