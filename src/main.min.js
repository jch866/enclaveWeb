/*! enclaveweb 2017-05-25 */
$(function(){function a(){v.keydown(function(a){a.preventDefault(),116===a.keyCode&&b()})}function b(){$(".artList").addClass("loadingBg"),$.get(Q.al,function(a){if(200==a.code){N.supports_ls()&&(N.setls(K.aL,JSON.stringify(a)),N.setls(K.aLT,(new Date).getTime()));var b=a.result.data;b.length=9,c(x,b),$(".artList").removeClass("loadingBg")}})}function c(a,b){switch(a){case x:x.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+t().preFix+b.art_id+t().postFix+'" ><img src='+b.art_thumb+' alt=""></a><a href="article.html?art_id='+t().preFix+b.art_id+t().postFix+'" ><h3>'+b.art_title+'</h3></a><a href="article.html?art_id='+t().preFix+b.art_id+t().postFix+'" ><p class="des">'+b.art_description+'</p></a><div class="editor"><p><span class="mark">'+b.cate_name+"</span>"+b.art_editor+"</p></div></li>";x.append($(c))});break;case C:var c='<img src="'+b.art_thumb+'" alt=""><h1>'+b.art_title+'</h1><div class="author"><img src="'+b.editor_avatar+'" alt=""><span>'+b.art_editor+" · "+r(1e3*b.art_time)+"</span></div>"+b.art_content.replace(/\/ueditor\/php/g,Q.homepage+"/ueditor/php")+'<div class="readOther"><span class="left mark">'+b.cate_name+'</span><span class="reads"><i></i>'+b.art_view+"</span></div>";C.html($(c));break;case y:y.html(""),$.each(b,function(a,b){var c='<li><a href="article.html?art_id='+t().preFix+b.art_id+t().postFix+'" ><img src='+b.art_thumb+' alt=""></a><div class="summary"><h2>'+b.art_title+"</h2><p>"+b.art_description+'</p><div><p><span class="mark">'+b.cate_name+"</span>"+b.art_editor+"</p></div></div></li>";y.append($(c))});break;case z:z.html(""),$.each(b,function(a,b){var c='<a href="article.html?art_id='+t().preFix+b.art_id+t().postFix+'" ><li><div class="imgWrap"><img src='+b.art_thumb+' alt=""></div><div class="des"><h3>'+b.art_title+"</h3><p>"+b.art_description+"</p></li></a>";z.append($(c))});break;case A:A.html(""),$.each(b,function(a,b){var c='<a href="article.html?art_id='+t().preFix+b.art_id+t().postFix+'" ><li><div class="imgWrap"><img src='+b.art_thumb+' alt=""></div><div class="des"><h3>'+b.art_title+"</h3><p>"+b.art_description+"</p></div></li></a>";A.append($(c))});break;case B:var c='<img src="'+b.art_thumb+'" alt=""><h1>'+b.art_title+'</h1><div class="author"><span>'+b.art_editor+" · "+r(1e3*b.art_time)+"</span></div>"+b.art_content.replace(/\/ueditor\/php/g,Q.homepage+"/ueditor/php")+'<div class="readOther"><span class="left mark">'+b.cate_name+'</span><span class="reads"><i></i>'+b.art_view+"</span></div>";B.html($(c))}}function d(){var a=JSON.parse(O),b=a.result.data;b.length=9,c(x,b)}function e(){if(P){return!!((new Date).getTime()-P<J)}return!1}function f(){O&&e()?d():b()}function g(a){var b=location.search.split("=")[1],d=b.substring(L),e=d.substring(0,d.length-M);$.get(Q.ad+"art_id="+e,function(b){if(200==b.code){var d=b.result;a?c(C,d):c(B,d)}}),h(a)}function h(a){$.get(Q.ar,function(b){if(200==b.code){var d=b.result.data;a?c(y,d):c(z,d)}})}function i(){v.scroll(function(){$(".article_head").outerHeight();var a=D.outerHeight();if($(document).height()<v.height()+a)return void(D.hasClass("fixedTop")&&D.removeClass("fixedTop"));v.scrollTop()>a?D.addClass("fixedTop"):D.removeClass("fixedTop")})}function j(){var a=0;F.length==E.length&&(F.on("click",function(){F.removeAttr("class"),$(this).addClass("curr"),a=F.index($(this)),E.hide(),E.eq(a).show()}),location.search&&k(F,E))}function k(a,b){var c=location.search.split("=")[1];a.removeAttr("class"),$(a[c]).addClass("curr"),b.hide(),b.eq(c).show()}function l(){var a=v.width(),b=a,c=v.height();w.css({width:b,height:c})}function m(){I.on("click",function(){$("body,html").animate({scrollTop:v.height()},400)})}function n(){$(".m_artList").addClass("loadingBg"),$.get(Q.al,function(a){if(200==a.code){var b=a.result.data;b.length=6,c(A,b),$(".m_artList").removeClass("loadingBg")}})}function o(){H.css({top:v.scrollTop(),height:window.innerHeight}),H.fadeIn(100),v.on("touchmove",function(a){a.preventDefault()})}function p(){H.fadeOut(100),v.off("touchmove")}function q(a){return a<10?"0"+a:a}function r(a){var b=new Date(a),c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds();return c+"-"+q(d)+"-"+q(e)+" "+q(f)+":"+q(g)+":"+q(h)}function s(a,b){var c=0,d=!1;a.addEventListener("touchstart",function(a){c=Date.now()}),a.addEventListener("touchmove",function(a){d=!0}),a.addEventListener("touchend",function(a){Date.now()-c>200||b(a)})}function t(){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=a.length,c=[],d=[],e=0;e<L;e++)c.push(a.charAt(u(0,b)));for(var f=0;f<M;f++)d.push(a.charAt(u(0,b)));return{preFix:c.join(""),postFix:d.join("")}}function u(a,b){var c=b-a;return Math.floor(Math.random()*c+a)}var v=$(window),w=$("#header"),x=$(".artList>ul"),y=$(".recommend>ul"),z=$(".m_recommend>ul"),A=$(".m_artList>ul"),B=$(".m_details"),C=$(".article_detail"),D=$(".article_head"),E=$(".menu_con"),F=$(".menu > a"),G=$("#m_weChat"),H=$("#mask"),I=$(".arrow"),J=108e5,K={aL:"artList",aLT:"artList_time"},L=6,M=3,N={supports_ls:function(){return!!window.localStorage},setls:function(a,b){window.localStorage[a]=b},getls:function(a){return window.localStorage[a]},rmls:function(a){window.localStorage.removeItem[a]}},O=!!N.supports_ls()&&N.getls(K.aL),P=!!N.supports_ls()&&N.getls(K.aLT)-0,Q={al:"https://app.enclavebooks.cn/v1_4/index",ad:"https://app.enclavebooks.cn/v1_4/article?",ar:"https://app.enclavebooks.cn/v1_4/recommend",homepage:"https://app.enclavebooks.cn"},R=0,S=$(".imgcls"),T=S.length;0!=x.length&&f(),0!=x.length&&a(),0!=C.length&&g(!0),0!=B.length&&g(!1),0!=D.length&&i(),0!=E.length&&j(),w&&l(),I&&m(),0!=A.length&&n(),0!=T&&window.setInterval(function(){R==T-1?R=0:R++,S.removeClass("active").removeClass("before"),S.eq(R).addClass("active"),0==R?S.eq(T-1).addClass("before"):S.eq(R-1).addClass("before")},5e3),G.on("click",function(){o()}),H.on("click",function(){p()});var U=document.getElementById("header");U&&s(U,function(){$("body,html").animate({scrollTop:v.height()},400)})});